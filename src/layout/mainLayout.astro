---
import '../styles/global.css';
import CookieBanner from '../components/CookieBanner.astro';

export interface Props {
  title?: string;
  description?: string;
}

const { title = "Holo Lux - AR Systems", description = "A New Paradigm for Energy-Efficient AR Displays" } = Astro.props;
---

<!DOCTYPE html>
<html lang="it" class="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="generator" content={Astro.generator} />
  <link rel="icon" type="image/x-icon" href="https://holo-lux.com/eng/assets/images/logp_solo.png">
  <title>{title}</title>
  <meta name="description" content={description}>
  
  <!-- Preload critical fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
  
  <!-- External dependencies -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js" defer></script>
  <script>
    // Force dark mode by default
    if (typeof window !== 'undefined') {
      const html = document.documentElement;
      const savedTheme = localStorage.getItem('theme');
      if (!savedTheme || savedTheme === 'light') {
        html.classList.add('dark');
        localStorage.setItem('theme', 'dark');
      } else if (savedTheme === 'dark') {
        html.classList.add('dark');
      }
    }
  </script>
  
  <style>
    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-20px); }
    }
    @keyframes glow {
      from { box-shadow: 0 0 20px #a855f7; }
      to { box-shadow: 0 0 30px #c084fc, 0 0 40px #c084fc; }
    }
    .glass-effect {
      background: rgba(15, 23, 42, 0.8);
      backdrop-filter: blur(16px);
      border: 1px solid rgba(148, 163, 184, 0.1);
    }
    .hero-gradient {
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
    }
  </style>
</head>
<body class="bg-slate-900 text-slate-100 font-sans antialiased dark">
  <!-- Page loader with modern tech design -->
  <div id="page-loader" class="fixed inset-0 bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950 flex items-center justify-center z-50">
    <div class="text-center">
      <!-- Modern spinner with tech styling -->
      <div class="relative mb-6 flex items-center justify-center">
        <div class="w-20 h-20 border-4 border-cyan-500/30 rounded-full"></div>
        <div class="absolute w-20 h-20 border-4 border-transparent border-t-cyan-400 rounded-full animate-spin"></div>
        <div class="absolute w-16 h-16 border-4 border-transparent border-t-purple-400 rounded-full animate-spin" style="animation-direction: reverse; animation-duration: 1.5s;"></div>
      </div>
      
      <!-- Loading text with tech styling -->
      <div class="space-y-2">
        <h3 class="text-2xl font-black">
          <span class="bg-gradient-to-r from-cyan-400 via-blue-500 to-purple-500 bg-clip-text text-transparent">HOLO</span>
          <span class="text-white ml-1">LUX</span>
        </h3>
        <p class="text-slate-300 font-medium">Initializing AR Display System...</p>
        <div class="flex justify-center space-x-1 mt-4">
          <div class="w-2 h-2 bg-cyan-400 rounded-full animate-pulse"></div>
          <div class="w-2 h-2 bg-blue-400 rounded-full animate-pulse" style="animation-delay: 0.2s;"></div>
          <div class="w-2 h-2 bg-purple-400 rounded-full animate-pulse" style="animation-delay: 0.4s;"></div>
        </div>
      </div>
    </div>
  </div>
  
    <!-- Scroll to top button with modern design -->
  <button id="scroll-to-top" class="fixed bottom-6 right-6 w-12 h-12 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-300 flex items-center justify-center opacity-0 transform translate-y-4 z-40">
    <i class="fas fa-chevron-up"></i>
  </button>
  
  <!-- Cookie Banner -->
  <CookieBanner />
  
  <slot />
  
  <!-- Inline JavaScript for functionality -->
  <script is:inline>
    // Multi-language support
    const translations = {
      it: {
        main_title: "Holo Lux",
        main_subtitle: "Display Opto-Meccanico Micro LED - Il Futuro della Realtà Aumentata",
        nav_efficiency: "Efficienza",
        nav_challenges: "La Sfida",
        nav_solution: "Tecnologia",
        nav_roadmap: "Applicazioni",
        nav_ai_analysis: "Utilità",
        efficiency_title: "Un Salto Quantico nell'Efficienza",
        efficiency_description: "Spostando l'elaborazione sul proiettore, gli occhiali HOLO LUX diventano incredibilmente efficienti, garantendo un'autonomia senza precedenti nel mondo della realtà aumentata.",
        consumption_chart_title: "Consumo Energetico Occhiali a Confronto",
        consumption_chart_caption: "Basato su una batteria standard da 500mAh (1850 mWh), comune nei moderni smart glasses",
        efficiency_chart_title: "Durata Batteria Stimata",
        efficiency_chart_caption: "Confronto dell'autonomia degli occhiali con batteria da 500mAh",
        transparency_chart_title: "Campo Visivo (FOV) vs Dimensione Specchio",
        transparency_chart_caption: "Relazione tra dimensione dello specchio MEMS e ampiezza del campo visivo",
        performance_title: "Feedback degli Utenti: Utilità Reale",
        performance_description: "Abbiamo chiesto ai potenziali utenti di valutare l'utilità di HOLO LUX in diversi scenari",
        power_reduction_title: "Durata Batteria",
        power_reduction_desc: "20 ore (vs 2-3 ore tradizionali)",
        transparency_improvement_title: "Efficienza Energetica",
        transparency_improvement_desc: "90mW (vs 750mW tradizionali)",
        efficiency_gain_title: "Batteria Standard",
        efficiency_gain_desc: "500mAh (1850 mWh) - autonomia 8x superiore",
        challenges_title: "Una Nuova Visione per l'AR",
        challenges_description: "Gli attuali visori AR soffrono di limiti evidenti: sono ingombranti, si surriscaldano e la batteria dura poche ore. HOLO LUX nasce per superare queste barriere.",
        challenge_power_title: "La Sfida Attuale",
        challenge_power_desc: "La tecnologia AR odierna richiede un'enorme potenza di calcolo a bordo, generando calore e consumando energia rapidamente. Questo si traduce in dispositivi scomodi e poco pratici per un uso prolungato.",
        challenge_transparency_title: "La Soluzione HOLO LUX",
        challenge_transparency_desc: "Il nostro sistema si sdoppia: un proiettore esterno genera l'immagine e degli occhiali leggeri e passivi la ricevono. Questo approccio, basato sulla Persistenza della Visione (POV), sposta il carico di lavoro dagli occhiali, rendendoli estremamente efficienti.",
        challenge_efficiency_title: "Come Funziona",
        challenge_efficiency_desc: "Un proiettore esterno modula un raggio di luce con le informazioni dell'immagine. Gli occhiali, dotati di un micro-specchio MEMS passivo, ricevono la luce e la riflettono sulla lente, 'dipingendo' l'immagine punto per punto.",
        solution_title: "La Tecnologia HOLO LUX",
        solution_description: "Il cuore di HOLO LUX è un innovativo sistema di proiezione opto-meccanico. Un proiettore esterno invia il segnale a occhiali riceventi che, tramite un micro-specchio (MEMS), rendono visibile l'immagine AR.",
        solution_step1: "Il Proiettore esterno modula un raggio di luce",
        solution_step2: "Gli Occhiali ricevono la luce tramite micro-specchio MEMS",
        solution_step3: "Lo specchio riflette la luce creando l'immagine AR",
        technology_comparison_title: "Confronto Tecnologico",
        technology_comparison_description: "Come la nostra tecnologia si confronta con le soluzioni esistenti",
        oled_title: "Occhiali AR Tradizionali",
        oled_description: "Display con elaborazione integrata e alto consumo energetico",
        oled_rest: "Consumo: 750mW",
        oled_active: "Durata: 2.5 ore (500mAh)",
        micro_led_title: "Occhiali HOLO LUX (Passivi)",
        micro_led_description: "Sistema innovativo con proiettore esterno e occhiali passivi",
        micro_led_rest: "Consumo: 90mW",
        micro_led_active: "Durata: 20+ ore (500mAh)",
        holographic_title: "Campo Visivo Variabile",
        holographic_description: "FOV regolabile in base alla dimensione dello specchio MEMS",
        holographic_rest: "3mm = 8.6°",
        holographic_active: "8mm = 22.6°",
        mirror: "Specchio",
        transparent: "Trasparente",
        roadmap_title: "Applicazioni Illimitate",
        roadmap_description: "La versatilità e l'efficienza di HOLO LUX aprono le porte a un'infinità di applicazioni in settori dove i display tradizionali sono impraticabili",
        roadmap_step1_title: "Industria 4.0",
        roadmap_step1_desc: "Istruzioni di assemblaggio e manutenzione a mani libere",
        roadmap_step2_title: "Logistica",
        roadmap_step2_desc: "Indicazioni di prelievo e smistamento direttamente nel campo visivo",
        roadmap_step3_title: "Sicurezza",
        roadmap_step3_desc: "Percorsi di evacuazione e avvisi in situazioni di emergenza",
        roadmap_step4_title: "Accessibilità",
        roadmap_step4_desc: "Ausili visivi per persone con disabilità, con testo e simboli ingranditi",
        ai_analysis_title: "Valutazione Utilità per Caso d'Uso",
        ai_analysis_description: "Abbiamo chiesto ai potenziali utenti di valutare l'utilità di HOLO LUX in diversi scenari. I risultati mostrano un forte interesse per le applicazioni in ambito industriale, di sicurezza e accessibilità",
        ai_result1_title: "Manutenzione",
        ai_result1_desc: "Punteggio utilità: 4.8/5 - Istruzioni sovrapposte direttamente sui componenti",
        ai_result2_title: "Industria",
        ai_result2_desc: "Punteggio utilità: 4.7/5 - Controllo qualità e assemblaggio guidato",
        ai_result3_title: "Sicurezza",
        ai_result3_desc: "Punteggio utilità: 4.6/5 - Avvisi di emergenza e percorsi di evacuazione",
        footer_text: "© 2025 Holo Lux. Innovazione nel futuro dei display AR.",
        theme_tooltip: "Cambia tema",
        language_tooltip: "Cambia lingua",
        // Privacy and Cookie translations
        cookie_title: "Informazioni sui Cookie",
        cookie_message: "Questo sito utilizza solo cookie tecnici essenziali per il funzionamento. Non raccogliamo né condividiamo alcun dato personale.",
        cookie_message_short: "Solo cookie tecnici, nessun dato raccolto.",
        privacy_policy: "Privacy Policy",
        accept_cookies: "Accetta",
        privacy_title: "Privacy Policy",
        privacy_subtitle: "La tua privacy è importante per noi. Ecco come proteggiamo i tuoi dati.",
        no_data_collection_title: "🛡️ Nessuna Raccolta Dati",
        no_data_collection_desc: "Holo Lux non raccoglie, memorizza o condivide alcun dato personale. Il nostro sito è completamente anonimo e rispettoso della privacy.",
        technical_cookies_title: "🍪 Cookie Tecnici",
        technical_cookies_desc: "Utilizziamo solo cookie tecnici essenziali per:",
        cookie_theme: "Memorizzare la preferenza del tema (chiaro/scuro)",
        cookie_language: "Salvare la lingua selezionata",
        cookie_banner: "Ricordare l'accettazione del banner cookie",
        no_third_party_title: "🚫 Nessun Servizio di Terze Parti",
        no_third_party_desc: "Non utilizziamo servizi di analisi, tracking o pubblicità di terze parti. Nessun Google Analytics, Facebook Pixel o simili.",
        local_storage_title: "💾 Memorizzazione Locale",
        local_storage_desc: "Le preferenze vengono salvate solo nel tuo browser (localStorage) e non vengono mai trasmesse ai nostri server.",
        contact_title: "📧 Contatti",
        contact_desc: "Per domande su questa Privacy Policy, puoi contattarci attraverso la sezione contatti del sito.",
        last_updated: "Ultimo aggiornamento: 25 Luglio 2025",
        gdpr_compliant: "100% GDPR Compliant - Privacy by Design",
        terms_title: "Termini di Servizio",
        terms_subtitle: "Condizioni d'uso per il sito web Holo Lux.",
        terms_acceptance_title: "📋 Accettazione dei Termini",
        terms_acceptance_desc: "Utilizzando il sito web Holo Lux, accetti automaticamente questi termini di servizio. Se non sei d'accordo, ti preghiamo di non utilizzare il sito.",
        terms_use_title: "🌐 Uso del Sito Web",
        terms_use_desc: "Il sito Holo Lux è fornito esclusivamente a scopo informativo e di ricerca. È consentito:",
        terms_allowed_view: "Visualizzare e navigare il contenuto",
        terms_allowed_download: "Scaricare materiali per uso personale",
        terms_allowed_share: "Condividere il link del sito",
        terms_ip_title: "💡 Proprietà Intellettuale",
        terms_ip_desc: "Tutti i contenuti del sito, inclusi testi, grafici, design e tecnologie descritte, sono protetti da diritti d'autore e proprietà intellettuale.",
        terms_research_title: "🔬 Scopo di Ricerca",
        terms_research_desc: "Il progetto Holo Lux è presentato a scopo di ricerca e sviluppo tecnologico. Le informazioni fornite sono teoriche e sperimentali.",
        terms_disclaimer_title: "⚠️ Disclaimer",
        terms_disclaimer_desc: "Le informazioni sono fornite \"così come sono\" senza garanzie di accuratezza o completezza. L'uso delle informazioni è a proprio rischio.",
        terms_warranty_title: "🛡️ Limitazione di Garanzia",
        terms_warranty_desc: "Il sito è fornito senza garanzie di alcun tipo. Non garantiamo che il servizio sia ininterrotto o privo di errori.",
        terms_changes_title: "🔄 Modifiche ai Termini",
        terms_changes_desc: "Ci riserviamo il diritto di modificare questi termini in qualsiasi momento. Le modifiche saranno pubblicate su questa pagina.",
        terms_last_updated: "Ultimo aggiornamento: 25 Luglio 2025",
        legal_notice: "Progetto di Ricerca Accademica",
        back_to_home: "Torna alla Home"
      },
      en: {
        main_title: "Holo Lux",
        main_subtitle: "Opto-Mechanical Micro LED Display - The Future of Augmented Reality",
        nav_efficiency: "Efficiency",
        nav_challenges: "The Challenge", 
        nav_solution: "Technology",
        nav_roadmap: "Applications",
        nav_ai_analysis: "Usefulness",
        efficiency_title: "A Quantum Leap in Efficiency",
        efficiency_description: "By offloading the processing to the projector, HOLO LUX glasses become incredibly efficient, ensuring unprecedented battery life in the world of augmented reality",
        consumption_chart_title: "Glasses Power Consumption Compared",
        consumption_chart_caption: "Based on a standard 500mAh (1850 mWh) battery, common in modern smart glasses",
        efficiency_chart_title: "Estimated Battery Life", 
        efficiency_chart_caption: "Comparison of glasses autonomy with 500mAh battery",
        transparency_chart_title: "Field of View (FOV) vs. Mirror Size",
        transparency_chart_caption: "Relationship between MEMS mirror size and field of view width",
        performance_title: "User Feedback: Real-World Usefulness",
        performance_description: "We asked potential users to rate the usefulness of HOLO LUX in various scenarios",
        power_reduction_title: "Battery Life",
        power_reduction_desc: "20 hours (vs 2-3 hours traditional)",
        transparency_improvement_title: "Energy Efficiency", 
        transparency_improvement_desc: "90mW (vs 750mW traditional)",
        efficiency_gain_title: "Standard Battery",
        efficiency_gain_desc: "500mAh (1850 mWh) - 8x longer autonomy",
        challenges_title: "A New Vision for AR",
        challenges_description: "Current AR headsets suffer from clear limitations: they are bulky, overheat, and their battery lasts only a few hours. HOLO LUX was born to overcome these barriers",
        challenge_power_title: "The Current Challenge",
        challenge_power_desc: "Today's AR technology requires enormous onboard computing power, generating heat and consuming energy rapidly. This results in uncomfortable and impractical devices for prolonged use",
        challenge_transparency_title: "The HOLO LUX Solution",
        challenge_transparency_desc: "Our system is twofold: an external projector generates the image, and lightweight, passive glasses receive it. This approach, based on Persistence of Vision (POV), offloads the workload from the glasses, making them extremely efficient",
        challenge_efficiency_title: "How It Works", 
        challenge_efficiency_desc: "An external projector modulates a light beam with image information. The glasses, equipped with a passive MEMS micro-mirror, receive the light and reflect it onto the lens, 'painting' the image point by point",
        solution_title: "The HOLO LUX Technology",
        solution_description: "The core of HOLO LUX is an innovative opto-mechanical projection system. An external projector sends the signal to receiving glasses which, via a micro-mirror (MEMS), make the AR image visible",
        solution_step1: "External Projector modulates a light beam",
        solution_step2: "Glasses receive light via MEMS micro-mirror",
        solution_step3: "Mirror reflects light creating the AR image",
        technology_comparison_title: "Technology Comparison",
        technology_comparison_description: "How our technology compares to existing solutions",
        oled_title: "Traditional AR Glasses",
        oled_description: "Displays with integrated processing and high energy consumption",
        oled_rest: "Consumption: 750mW",
        oled_active: "Duration: 2.5 hours (500mAh)",
        micro_led_title: "HOLO LUX Glasses (Passive)",
        micro_led_description: "Innovative system with external projector and passive glasses",
        micro_led_rest: "Consumption: 90mW", 
        micro_led_active: "Duration: 20+ hours (500mAh)",
        holographic_title: "Variable Field of View",
        holographic_description: "Adjustable FOV based on MEMS mirror size",
        holographic_rest: "3mm = 8.6°",
        holographic_active: "8mm = 22.6°",
        mirror: "Mirror",
        transparent: "Transparent", 
        roadmap_title: "Limitless Applications",
        roadmap_description: "The versatility and efficiency of HOLO LUX open the door to countless applications in sectors where traditional displays are impractical",
        roadmap_step1_title: "Industry 4.0",
        roadmap_step1_desc: "Hands-free assembly and maintenance instructions",
        roadmap_step2_title: "Logistics",
        roadmap_step2_desc: "Picking and sorting directions directly in the field of view",
        roadmap_step3_title: "Security",
        roadmap_step3_desc: "Evacuation routes and warnings in emergency situations",
        roadmap_step4_title: "Accessibility",
        roadmap_step4_desc: "Visual aids for people with disabilities, with enlarged text and symbols",
        ai_analysis_title: "Usefulness Rating by Use Case",
        ai_analysis_description: "We asked potential users to rate the usefulness of HOLO LUX in various scenarios. The results show strong interest in industrial, security, and accessibility applications",
        ai_result1_title: "Maintenance",
        ai_result1_desc: "Usefulness score: 4.8/5 - Instructions overlaid directly on components",
        ai_result2_title: "Industry",
        ai_result2_desc: "Usefulness score: 4.7/5 - Quality control and guided assembly",
        ai_result3_title: "Security", 
        ai_result3_desc: "Usefulness score: 4.6/5 - Emergency alerts and evacuation routes",
        footer_text: "© 2025 Holo Lux. Innovation in the future of AR displays.",
        theme_tooltip: "Change theme",
        language_tooltip: "Change language",
        // Privacy and Cookie translations
        cookie_title: "Cookie Information",
        cookie_message: "This site only uses essential technical cookies for functionality. We do not collect or share any personal data.",
        cookie_message_short: "Technical cookies only, no data collected.",
        privacy_policy: "Privacy Policy",
        accept_cookies: "Accept",
        privacy_title: "Privacy Policy",
        privacy_subtitle: "Your privacy is important to us. Here's how we protect your data.",
        no_data_collection_title: "🛡️ No Data Collection",
        no_data_collection_desc: "Holo Lux does not collect, store or share any personal data. Our site is completely anonymous and privacy-respecting.",
        technical_cookies_title: "🍪 Technical Cookies",
        technical_cookies_desc: "We only use essential technical cookies for:",
        cookie_theme: "Storing theme preference (light/dark)",
        cookie_language: "Saving selected language",
        cookie_banner: "Remembering cookie banner acceptance",
        no_third_party_title: "🚫 No Third-Party Services",
        no_third_party_desc: "We don't use third-party analytics, tracking or advertising services. No Google Analytics, Facebook Pixel or similar.",
        local_storage_title: "💾 Local Storage",
        local_storage_desc: "Preferences are saved only in your browser (localStorage) and never transmitted to our servers.",
        contact_title: "📧 Contact",
        contact_desc: "For questions about this Privacy Policy, you can contact us through the site's contact section.",
        last_updated: "Last updated: July 25, 2025",
        gdpr_compliant: "100% GDPR Compliant - Privacy by Design",
        terms_title: "Terms of Service",
        terms_subtitle: "Terms of use for the Holo Lux website.",
        terms_acceptance_title: "📋 Terms Acceptance",
        terms_acceptance_desc: "By using the Holo Lux website, you automatically accept these terms of service. If you disagree, please do not use the site.",
        terms_use_title: "🌐 Website Use",
        terms_use_desc: "The Holo Lux site is provided exclusively for informational and research purposes. You may:",
        terms_allowed_view: "View and navigate content",
        terms_allowed_download: "Download materials for personal use",
        terms_allowed_share: "Share the site link",
        terms_ip_title: "💡 Intellectual Property",
        terms_ip_desc: "All site content, including texts, graphics, design and described technologies, are protected by copyright and intellectual property rights.",
        terms_research_title: "🔬 Research Purpose",
        terms_research_desc: "The Holo Lux project is presented for research and technological development purposes. The information provided is theoretical and experimental.",
        terms_disclaimer_title: "⚠️ Disclaimer",
        terms_disclaimer_desc: "Information is provided \"as is\" without warranties of accuracy or completeness. Use of information is at your own risk.",
        terms_warranty_title: "🛡️ Warranty Limitation",
        terms_warranty_desc: "The site is provided without warranties of any kind. We do not guarantee that the service will be uninterrupted or error-free.",
        terms_changes_title: "🔄 Terms Changes",
        terms_changes_desc: "We reserve the right to modify these terms at any time. Changes will be posted on this page.",
        terms_last_updated: "Last updated: July 25, 2025",
        legal_notice: "Academic Research Project",
        back_to_home: "Back to Home"
      }
    };

    let currentLanguage = 'it';

    function updateTexts() {
      const elements = document.querySelectorAll('[data-lang-key]');
      elements.forEach(element => {
        const key = element.getAttribute('data-lang-key');
        if (translations[currentLanguage] && translations[currentLanguage][key]) {
          element.textContent = translations[currentLanguage][key];
        }
      });
      
      const langBtn = document.getElementById('lang-toggle-btn');
      if (langBtn) {
        const flagSpan = langBtn.querySelector('span');
        
        if (flagSpan) {
          if (currentLanguage === 'it') {
            flagSpan.textContent = '🇺🇸';
          } else {
            flagSpan.textContent = '🇮🇹';
          }
        }
      }
    }

    function toggleLanguage() {
      currentLanguage = currentLanguage === 'it' ? 'en' : 'it';
      updateTexts();
      if (typeof renderCharts === 'function') {
        renderCharts();
      }
    }

    // Theme management
    function initializeTheme() {
      const themeToggleBtn = document.getElementById('theme-toggle-btn');
      const themeIcon = document.getElementById('theme-icon');
      const html = document.documentElement;
      
      // Force dark mode as default
      let currentTheme = localStorage.getItem('theme') || 'dark';
      html.classList.add('dark');
      if (currentTheme === 'light') {
        currentTheme = 'dark';
        localStorage.setItem('theme', 'dark');
      }
      updateThemeIcon(themeIcon, currentTheme);
      
      if (themeToggleBtn) {
        themeToggleBtn.addEventListener('click', () => {
          currentTheme = currentTheme === 'light' ? 'dark' : 'light';
          html.classList.toggle('dark', currentTheme === 'dark');
          localStorage.setItem('theme', currentTheme);
          updateThemeIcon(themeIcon, currentTheme);
          if (typeof renderCharts === 'function') {
            setTimeout(() => renderCharts(), 100);
          }
        });
      }
    }

    function updateThemeIcon(iconElement, theme) {
      if (!iconElement) return;
      iconElement.className = theme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
    }

    // Smooth scrolling
    function initializeSmoothScrolling() {
      document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
          e.preventDefault();
          const target = document.querySelector(this.getAttribute('href'));
          if (target) {
            target.scrollIntoView({ behavior: 'smooth', block: 'start' });
          }
        });
      });
      
      // Scroll to top button functionality
      const scrollToTopBtn = document.getElementById('scroll-to-top');
      if (scrollToTopBtn) {
        // Show/hide button based on scroll position
        window.addEventListener('scroll', () => {
          if (window.pageYOffset > 300) {
            scrollToTopBtn.classList.add('visible');
          } else {
            scrollToTopBtn.classList.remove('visible');
          }
        });
        
        // Scroll to top when clicked
        scrollToTopBtn.addEventListener('click', () => {
          window.scrollTo({ top: 0, behavior: 'smooth' });
        });
      }
    }

    // Chart functions
    function getChartColors(isDark = false) {
      return {
        primary: isDark ? '#4DA6FF' : '#0073E6',
        secondary: isDark ? '#66B3FF' : '#0059B3', 
        accent: isDark ? '#80C4FF' : '#004080',
        background: isDark ? '#1F2937' : '#FFFFFF',
        text: isDark ? '#F3F4F6' : '#374151',
        grid: isDark ? '#374151' : '#E5E7EB'
      };
    }

    function renderCharts() {
      if (typeof Chart === 'undefined') return;
      
      setTimeout(() => {
        createConsumptionChart();
        createEfficiencyChart();
        createTransparencyChart();
      }, 150);
    }

    function createConsumptionChart() {
      const canvas = document.getElementById('consumptionChart');
      if (!canvas) return;
      
      const ctx = canvas.getContext('2d');
      const isDark = document.documentElement.classList.contains('dark');
      const colors = getChartColors(isDark);
      
      if (window.consumptionChartInstance) {
        window.consumptionChartInstance.destroy();
      }
      
      window.consumptionChartInstance = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: [currentLanguage === 'it' ? 'Occhiali AR Tradizionali' : 'Traditional AR Glasses', currentLanguage === 'it' ? 'Occhiali HOLO LUX (Passivi)' : 'HOLO LUX Glasses (Passive)'],
          datasets: [{
            label: currentLanguage === 'it' ? 'Consumo Energetico Medio (mW)' : 'Average Power Consumption (mW)',
            data: [750, 90],
            backgroundColor: [
              'rgba(239, 68, 68, 0.6)',
              'rgba(34, 197, 94, 0.6)'
            ],
            borderColor: ['rgba(239, 68, 68, 1)', 'rgba(34, 197, 94, 1)'],
            borderWidth: 2,
            borderRadius: 8
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              labels: {
                color: colors.text,
                font: { family: 'Inter, sans-serif', weight: '600' }
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              grid: { color: colors.grid },
              ticks: { color: colors.text, font: { family: 'Inter, sans-serif' } }
            },
            x: {
              grid: { color: colors.grid },
              ticks: { color: colors.text, font: { family: 'Inter, sans-serif', weight: '600' } }
            }
          }
        }
      });
    }

    function createEfficiencyChart() {
      const canvas = document.getElementById('efficiencyChart');
      if (!canvas) return;
      
      const ctx = canvas.getContext('2d');
      const isDark = document.documentElement.classList.contains('dark');
      const colors = getChartColors(isDark);
      
      if (window.efficiencyChartInstance) {
        window.efficiencyChartInstance.destroy();
      }
      
      window.efficiencyChartInstance = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: [
            currentLanguage === 'it' ? ['Manutenzione'] : ['Maintenance'],
            currentLanguage === 'it' ? ['Industria'] : ['Industry'], 
            currentLanguage === 'it' ? ['Sicurezza'] : ['Security'],
            currentLanguage === 'it' ? ['Accessibilità'] : ['Accessibility'],
            currentLanguage === 'it' ? ['Difesa'] : ['Defense'],
            currentLanguage === 'it' ? ['Magazzini'] : ['Warehouses'],
            currentLanguage === 'it' ? ['Veicoli'] : ['Vehicles'],
            currentLanguage === 'it' ? ['Musei'] : ['Museums']
          ],
          datasets: [{
            label: currentLanguage === 'it' ? 'Punteggio Utilità (da 1 a 5)' : 'Usefulness Score (1 to 5)',
            data: [4.8, 4.7, 4.6, 4.5, 4.4, 4.2, 4.1, 3.8],
            backgroundColor: 'rgba(139, 92, 246, 0.6)',
            borderColor: 'rgba(139, 92, 246, 1)',
            borderWidth: 2,
            borderRadius: 6
          }]
        },
        options: {
          indexAxis: 'y',
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false }
          },
          scales: {
            x: { 
              beginAtZero: true, 
              max: 5, 
              grid: { color: colors.grid }, 
              ticks: { color: colors.text }
            },
            y: { 
              grid: { color: 'rgba(255, 255, 255, 0.05)' }, 
              ticks: { color: colors.text }
            }
          }
        }
      });
    }

    function createTransparencyChart() {
      const canvas = document.getElementById('transparencyChart');
      if (!canvas) return;
      
      const ctx = canvas.getContext('2d');
      const isDark = document.documentElement.classList.contains('dark');
      const colors = getChartColors(isDark);
      
      if (window.transparencyChartInstance) {
        window.transparencyChartInstance.destroy();
      }
      
      window.transparencyChartInstance = new Chart(ctx, {
        type: 'line',
        data: {
          labels: ['3mm', '4mm', '5mm', '6mm', '7mm', '8mm'],
          datasets: [{
            label: currentLanguage === 'it' ? 'FOV (Gradi)' : 'FOV (Degrees)',
            data: [8.6, 11.4, 14.2, 17.1, 20.0, 22.6],
            borderColor: colors.primary,
            backgroundColor: colors.primary + '20',
            borderWidth: 4,
            fill: false,
            tension: 0.1,
            pointBackgroundColor: colors.primary,
            pointBorderColor: colors.background,
            pointBorderWidth: 3,
            pointRadius: 6
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              labels: {
                color: colors.text,
                font: { family: 'Inter, sans-serif', weight: '600' }
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              max: 25,
              grid: { color: colors.grid },
              ticks: { 
                color: colors.text,
                font: { family: 'Inter, sans-serif' },
                callback: function(value) { return value + '°'; }
              },
              title: {
                display: true,
                text: currentLanguage === 'it' ? 'Gradi (°)' : 'Degrees (°)',
                color: colors.text
              }
            },
            x: {
              grid: { color: colors.grid },
              ticks: { color: colors.text, font: { family: 'Inter, sans-serif', weight: '600' } },
              title: {
                display: true,
                text: currentLanguage === 'it' ? 'Dimensione Specchio MEMS' : 'MEMS Mirror Size',
                color: colors.text
              }
            }
          }
        }
      });
    }

    // Page loader functionality
    function hidePageLoader() {
      const loader = document.getElementById('page-loader');
      if (loader) {
        setTimeout(() => {
          loader.classList.add('hidden');
          setTimeout(() => {
            loader.style.display = 'none';
          }, 500);
        }, 300);
      }
    }

    // Initialize everything when DOM loads
    document.addEventListener('DOMContentLoaded', function() {
      updateTexts();
      initializeTheme();
      initializeSmoothScrolling();
      initializeScrollAnimations();
      
      const langBtn = document.getElementById('lang-toggle-btn');
      if (langBtn) {
        langBtn.addEventListener('click', toggleLanguage);
      }
      
      // Wait for Chart.js to load before rendering charts
      if (typeof Chart !== 'undefined') {
        renderCharts();
        hidePageLoader();
      } else {
        const checkChart = setInterval(() => {
          if (typeof Chart !== 'undefined') {
            clearInterval(checkChart);
            renderCharts();
            hidePageLoader();
          }
        }, 100);
      }
    });

    // Scroll animations
    function initializeScrollAnimations() {
      // Respect user's reduced motion preference
      const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)');
      const isMobile = window.innerWidth <= 768;
      
      if (prefersReducedMotion.matches) {
        // If user prefers reduced motion, just show elements immediately
        document.querySelectorAll('.animate-on-scroll').forEach(el => {
          el.classList.add('in-view');
        });
        return;
      }
      
      const observerOptions = {
        threshold: isMobile ? 0.05 : 0.1,
        rootMargin: isMobile ? '0px 0px -20px 0px' : '0px 0px -50px 0px'
      };

      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('in-view');
            // Add staggered animation for grid items (desktop only for performance)
            if (entry.target.classList.contains('grid') && !isMobile) {
              const children = entry.target.children;
              Array.from(children).forEach((child, index) => {
                setTimeout(() => {
                  child.style.opacity = '1';
                  child.style.transform = 'translateY(0)';
                }, index * 100);
              });
            }
            // Unobserve element after animation to improve performance
            observer.unobserve(entry.target);
          }
        });
      }, observerOptions);

      // Observe all animatable elements
      document.querySelectorAll('.animate-on-scroll, section, .step-card, .ai-result-card').forEach(el => {
        observer.observe(el);
      });

      // Add parallax effect to header (desktop only for performance)
      if (window.innerWidth > 768) {
        window.addEventListener('scroll', () => {
          const scrolled = window.pageYOffset;
          const header = document.querySelector('header');
          if (header) {
            header.style.transform = `translateY(${scrolled * 0.3}px)`;
          }
        });
      }
    }
  </script>
</body>
</html>

<style>
  body {
    font-family: 'Inter', sans-serif;
    transition: background-color 0.3s ease, color 0.3s ease;
  }
  
  .chart-container {
    position: relative;
    width: 100%;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
    height: 280px;
    max-height: 40vh;
    opacity: 0;
    transform: translateY(30px);
    animation: fadeInUp 0.8s ease-out forwards;
  }
  
  @media (min-width: 768px) {
    .chart-container {
      height: 380px;
      max-height: 50vh;
    }
  }

  @keyframes fadeInUp {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes slideInLeft {
    from {
      opacity: 0;
      transform: translateX(-50px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  @keyframes slideInRight {
    from {
      opacity: 0;
      transform: translateX(50px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  @keyframes scaleIn {
    from {
      opacity: 0;
      transform: scale(0.8);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes pulse {
    0%, 100% {
      transform: scale(1);
    }
    50% {
      transform: scale(1.05);
    }
  }

  .animate-on-scroll {
    opacity: 0;
    transform: translateY(50px);
    transition: all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  }

  .animate-on-scroll.in-view {
    opacity: 1;
    transform: translateY(0);
  }

  .stagger-animation:nth-child(1) { animation-delay: 0.1s; }
  .stagger-animation:nth-child(2) { animation-delay: 0.2s; }
  .stagger-animation:nth-child(3) { animation-delay: 0.3s; }
  .stagger-animation:nth-child(4) { animation-delay: 0.4s; }
  
  .step-card {
    transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    height: 100%;
    background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255,255,255,0.1);
    position: relative;
    overflow: hidden;
  }

  .step-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
    transition: left 0.5s ease;
  }

  .step-card:hover::before {
    left: 100%;
  }

  .step-card:hover {
    transform: translateY(-8px) scale(1.02);
    box-shadow: 0 20px 40px rgba(0, 115, 230, 0.2);
    border-color: rgba(0, 115, 230, 0.3);
  }

  .dark .step-card {
    background: linear-gradient(135deg, rgba(31, 41, 55, 0.8) 0%, rgba(55, 65, 81, 0.6) 100%);
    border-color: rgba(75, 85, 99, 0.3);
  }

  .dark .step-card:hover {
    box-shadow: 0 20px 40px rgba(77, 166, 255, 0.3);
    border-color: rgba(77, 166, 255, 0.5);
  }
  
  .step-icon {
    font-size: 3rem;
    color: #0073E6;
    margin-bottom: 1rem;
    transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    display: inline-block;
  }

  .step-card:hover .step-icon {
    transform: scale(1.2) rotate(10deg);
    color: #004080;
    text-shadow: 0 0 20px rgba(0, 115, 230, 0.5);
  }
  
  .dark .step-icon {
    color: #4DA6FF;
  }

  .dark .step-card:hover .step-icon {
    color: #66B3FF;
    text-shadow: 0 0 25px rgba(77, 166, 255, 0.6);
  }
  
  .ai-result-card {
    border-left-width: 5px;
    transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    position: relative;
    overflow: hidden;
    background: linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(248,250,252,0.9) 100%);
  }

  .ai-result-card::after {
    content: '';
    position: absolute;
    top: 0;
    right: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(0,115,230,0.05), transparent);
    transition: right 0.6s ease;
  }

  .ai-result-card:hover::after {
    right: 100%;
  }

  .ai-result-card:hover {
    transform: translateX(10px) scale(1.02);
    box-shadow: -5px 15px 35px rgba(0, 115, 230, 0.15);
    border-left-color: #0059B3;
  }

  .dark .ai-result-card {
    background: linear-gradient(135deg, rgba(31, 41, 55, 0.95) 0%, rgba(55, 65, 81, 0.9) 100%);
  }

  .dark .ai-result-card:hover {
    box-shadow: -5px 15px 35px rgba(77, 166, 255, 0.2);
    border-left-color: #66B3FF;
  }
  
  .ai-result-card h4 {
    transition: all 0.3s ease;
  }

  .ai-result-card:hover h4 {
    transform: translateX(5px);
  }
  
  .settings-button {
    background-color: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 0.5rem;
    padding: 0.5rem 1rem;
    color: white;
    font-weight: 600;
    transition: background-color 0.2s ease;
  }
  
  .settings-button:hover {
    background-color: rgba(255, 255, 255, 0.2);
  }
</style>